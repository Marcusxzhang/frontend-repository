# 微服务实战系列文章 #
转自**dockone.io**  
https://blog.csdn.net/kenkao/article/details/54171437  
## 微服务实战（一）： 微服务架构的优势与不足 ##
微服务架构更适合用于**构建复杂的应用**。  
  
首先，我们看看为什么要考虑使用微服务。  
  
**= 开发单体应用 =**  
假设我们需要开发一个出租车调度软件，我们需要使用基于`Rails`，`Spring Boot`，`Play`或者`Maven`的生成器来开始这个项目，他的六边形架构是模块化的，如图：  
![car-rent-structure](http://dockerone.com/uploads/article/20150524/89d9bfed11ff35943269b24b23b866b1.png "car-rent-structure")  
  
应用核心是**业务逻辑**，由定于服务、域对象和事件的模块完成。围绕着核心的是与外界打交道的**适配器（Adapter）**，包括：  
* 数据库访问组件
* 生产和处理消息的消息组件
* 提供API或者UI访问支持的Web模块
* ...  
  
尽管也是模块化逻辑，但是最终还是会打包并部署为单体式应用。具体的格式依赖于**应用语言和框架**。  
  
IDE和其他工具都擅长开发一个简单应用，只需要运行这个应用，然后用`Selenium`链接UI就可以完成e2e测试。同时只需要打包到服务器，通过**负载均衡**运行多个拷贝就可以实现应用拓展。  
  
**= 单体应用的不足 =**  
单体应用随着规模的增大，开发团队就会在敏捷开发和部署举步维艰，具体的不足如下：  
* 降低开发速度
* 不利于持续性开发
* 在不同模块发生资源冲突时，扩展将会非常困难
* bug会影响整个应用的可靠性
* 采用新架构和语言非常困难
  
**= 微处理架构 —— 处理复杂事物 =**  
其思路不是开发一个巨大的单体式应用，而是将应用分解为小的、互相连接的微服务。  
  
一个微服务一般完成某个特定功能，都有自己的业务逻辑和适配器。运行时，每一个实例可能是一个云VM或者Docker容器。  
  
根据这个理论，我们可以将架构拆分为：  
![micro-service](http://dockerone.com/uploads/article/20150524/858f9ae6c861c8c93cd5379be54f9fc1.png "micro-service")  
  
每一个后台服务开放一个**REST API**，所有服务都采用异步的，基于消息的通讯。  
  
一个REST API也对其他应用开放，这些应用不直接访问后台服务，而是通过API Gateway来传递中间消息。API Gateway负责负载均衡、缓存、访问控制、API计费监控等等。可以通过`NGINX`方便实现。  
  
![micro-service-docker](http://dockerone.com/uploads/article/20150524/ca6ddafaa8b506ae4d45dde53ee5efb6.png "micro-service-docker")  
  
运行时，每一个服务实例都是一个Docker容器，这些容器一般运行在多个云VM上。服务实例前是一层诸如NGINX的负载均衡器，负责在各个实例间分发请求。  
  
这种微服务架构影响了应用和数据库之间的关系，**不像传统多个服务共享一个数据库，微服务架构每个服务都有自己的数据库**。  
![micro-service-database](http://dockerone.com/uploads/article/20150524/384781ccf56d3057df5acd198e8d1f3d.png "micro-service-database")  
  
**= 微服务架构的好处 =**  
关于微服务架构的好处：  
* 解决了复杂性问题。很容易开发、理解和维护。
* 每个服务可以有独立的开发团队开发，可以自由选择开发技术，提供API服务。
* 微服务架构是每个微服务独立的部署，不需要协调其他服务对本服务的影响。
* 微服务使每个服务独立扩展。可以根据每个服务的规模来部署满足需求的规模。
  
**= 微服务架构的不足 =**  
关于微服务架构的不足：  
* 微服务的目的是有效拆分应用，实现敏捷开发和部署。  
* 微服务应用是分布式系统，会带来固有的复杂性。开发者需要在RPC(Remote Procedure Call)或者消息传递之间选择并完成进程间通讯机制。必须写代码来处理消息传递中速度过慢或者不可用等局部失效问题。  
* 微服务来自分区的数据库架构，单体式应用使用的是一个数据库，所以更新消息会比较方便。但微服务需要更新不同服务使用不同的数据库。  
* 与此同时，测试一个基于微服务架构的应用非常复杂。需要启动和他有关的所有服务。  
* 微服务架构应用的改变会波及多个服务。  
  
关于如何部署微服务：  
* 一个分布式应用只需要在复杂均衡器后面部署各自的服务器。微服务每个实例都需要配置，部署，扩展和监控。还需要完成**服务发现机制**，用来发现与他通讯服务的地址（包括服务器地址和端口）。成功部署一个微服务应用需要开发者拥有的控制部署方法，并高度自动化。
* 使用PaaS服务，他给开发者提供一个部署和管理微服务的简单方法。
  
## 微服务实战（二）： 使用API Gateway ##
## 微服务实战（三）： 深入微服务架构的进程间通信 ##
## 微服务实战（四）： 服务发现的可行方案以及实践案例 ##
## 微服务实战（五）： 微服务的事件驱动数据管理 ##
## 微服务实战（六）： 选择微服务部署策略 ##
## 微服务实战（七）： 从单体式架构迁移到微服务架构 ##